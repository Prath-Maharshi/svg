<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2131pt" height="571pt" viewBox="0.00 0.00 2131.00 571.20">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 567.2)">
<title>GeneralizedStanModel</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-567.2 2127,-567.2 2127,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_data</title>
<polygon fill="lightyellow" stroke="black" points="8,-478.4 8,-555.2 924,-555.2 924,-478.4 8,-478.4"/>
<text text-anchor="middle" x="466" y="-538.6" font-family="Times,serif" font-size="14.00">Data Input</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_transformed_data</title>
<polygon fill="lightyellow" stroke="black" points="155,-393.6 155,-470.4 924,-470.4 924,-393.6 155,-393.6"/>
<text text-anchor="middle" x="539.5" y="-453.8" font-family="Times,serif" font-size="14.00">Transformed Data</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_parameters</title>
<polygon fill="lightyellow" stroke="black" points="932,-478.4 932,-555.2 2115,-555.2 2115,-478.4 932,-478.4"/>
<text text-anchor="middle" x="1523.5" y="-538.6" font-family="Times,serif" font-size="14.00">Parameters</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_model</title>
<polygon fill="lightyellow" stroke="black" points="932,-249.6 932,-470.4 1612,-470.4 1612,-249.6 932,-249.6"/>
<text text-anchor="middle" x="1272" y="-453.8" font-family="Times,serif" font-size="14.00">Model Computation</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_copula</title>
<polygon fill="lightyellow" stroke="black" points="195,-92.8 195,-241.6 845,-241.6 845,-92.8 195,-92.8"/>
<text text-anchor="middle" x="520" y="-225" font-family="Times,serif" font-size="14.00">Copula Fitting</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<polygon fill="lightyellow" stroke="black" points="340,-8 340,-84.8 514,-84.8 514,-8 340,-8"/>
<text text-anchor="middle" x="427" y="-68.2" font-family="Times,serif" font-size="14.00">Output</text>
</g>
<!-- Observations -->
<g id="node1" class="node">
<title>Observations</title>
<polygon fill="lightblue" stroke="black" points="381.85,-522.4 272.15,-522.4 272.15,-486.4 381.85,-486.4 381.85,-522.4"/>
<text text-anchor="middle" x="327" y="-500.2" font-family="Times,serif" font-size="14.00">Observations (y)</text>
</g>
<!-- TransformedObservations -->
<g id="node6" class="node">
<title>TransformedObservations</title>
<polygon fill="lightblue" stroke="black" points="385.42,-437.6 162.58,-437.6 162.58,-401.6 385.42,-401.6 385.42,-437.6"/>
<text text-anchor="middle" x="274" y="-415.4" font-family="Times,serif" font-size="14.00">Transformed Observations (y_t, y_s)</text>
</g>
<!-- Observations&#45;&gt;TransformedObservations -->
<g id="edge1" class="edge">
<title>Observations-&gt;TransformedObservations</title>
<path fill="none" stroke="black" d="M316.02,-486.24C308.89,-475.11 299.45,-460.35 291.32,-447.65"/>
<polygon fill="black" stroke="black" points="294.3,-445.83 285.97,-439.29 288.41,-449.6 294.3,-445.83"/>
</g>
<!-- DistanceMatrix -->
<g id="node2" class="node">
<title>DistanceMatrix</title>
<polygon fill="lightblue" stroke="black" points="735.82,-522.4 596.18,-522.4 596.18,-486.4 735.82,-486.4 735.82,-522.4"/>
<text text-anchor="middle" x="666" y="-500.2" font-family="Times,serif" font-size="14.00">Distance Matrix (dist)</text>
</g>
<!-- GroupDistanceMatrices -->
<g id="node8" class="node">
<title>GroupDistanceMatrices</title>
<polygon fill="lightblue" stroke="black" points="915.61,-437.6 692.39,-437.6 692.39,-401.6 915.61,-401.6 915.61,-437.6"/>
<text text-anchor="middle" x="804" y="-415.4" font-family="Times,serif" font-size="14.00">Group Distance Matrices (dist_mats)</text>
</g>
<!-- DistanceMatrix&#45;&gt;GroupDistanceMatrices -->
<g id="edge2" class="edge">
<title>DistanceMatrix-&gt;GroupDistanceMatrices</title>
<path fill="none" stroke="black" d="M694.93,-486.04C715.35,-473.79 742.95,-457.23 765.27,-443.84"/>
<polygon fill="black" stroke="black" points="767.04,-446.86 773.81,-438.71 763.44,-440.86 767.04,-446.86"/>
</g>
<!-- SpatialCovariates -->
<g id="node3" class="node">
<title>SpatialCovariates</title>
<polygon fill="lightblue" stroke="black" points="916.08,-522.4 753.92,-522.4 753.92,-486.4 916.08,-486.4 916.08,-522.4"/>
<text text-anchor="middle" x="835" y="-500.2" font-family="Times,serif" font-size="14.00">Spatial Covariate (covars)</text>
</g>
<!-- RegressionCoefficients -->
<g id="node14" class="node">
<title>RegressionCoefficients</title>
<polygon fill="lightblue" stroke="black" points="1535.14,-437.6 1348.86,-437.6 1348.86,-401.6 1535.14,-401.6 1535.14,-437.6"/>
<text text-anchor="middle" x="1442" y="-415.4" font-family="Times,serif" font-size="14.00">Regression Coefficients (beta)</text>
</g>
<!-- SpatialCovariates&#45;&gt;RegressionCoefficients -->
<g id="edge4" class="edge">
<title>SpatialCovariates-&gt;RegressionCoefficients</title>
<path fill="none" stroke="black" d="M894.73,-485.92C905.73,-483.11 917.16,-480.45 928,-478.4 1068.46,-451.78 1233,-435.92 1337.35,-427.72"/>
<polygon fill="black" stroke="black" points="1337.31,-431.24 1347.01,-426.98 1336.76,-424.26 1337.31,-431.24"/>
</g>
<!-- TemporalCovariates -->
<g id="node4" class="node">
<title>TemporalCovariates</title>
<polygon fill="lightblue" stroke="black" points="578.63,-522.4 399.37,-522.4 399.37,-486.4 578.63,-486.4 578.63,-522.4"/>
<text text-anchor="middle" x="489" y="-500.2" font-family="Times,serif" font-size="14.00">Temporal Covariate (covar1)</text>
</g>
<!-- TransformedCovariates -->
<g id="node7" class="node">
<title>TransformedCovariates</title>
<polygon fill="lightblue" stroke="black" points="674.51,-437.6 403.49,-437.6 403.49,-401.6 674.51,-401.6 674.51,-437.6"/>
<text text-anchor="middle" x="539" y="-415.4" font-family="Times,serif" font-size="14.00">Transformed Covariates (covar1_t, covar1_s)</text>
</g>
<!-- TemporalCovariates&#45;&gt;TransformedCovariates -->
<g id="edge3" class="edge">
<title>TemporalCovariates-&gt;TransformedCovariates</title>
<path fill="none" stroke="black" d="M499.36,-486.24C506.09,-475.11 514.99,-460.35 522.66,-447.65"/>
<polygon fill="black" stroke="black" points="525.53,-449.68 527.7,-439.31 519.53,-446.07 525.53,-449.68"/>
</g>
<!-- Hyperparameters -->
<g id="node5" class="node">
<title>Hyperparameters</title>
<polygon fill="lightblue" stroke="black" points="254.36,-522.4 15.64,-522.4 15.64,-486.4 254.36,-486.4 254.36,-522.4"/>
<text text-anchor="middle" x="135" y="-500.2" font-family="Times,serif" font-size="14.00">Hyperparameters (e.g., mle_cop_range)</text>
</g>
<!-- CopulaLogProbability -->
<g id="node21" class="node">
<title>CopulaLogProbability</title>
<polygon fill="lightblue" stroke="black" points="519.18,-136.8 334.82,-136.8 334.82,-100.8 519.18,-100.8 519.18,-136.8"/>
<text text-anchor="middle" x="427" y="-114.6" font-family="Times,serif" font-size="14.00">Copula Log Probability (eclp)</text>
</g>
<!-- Hyperparameters&#45;&gt;CopulaLogProbability -->
<g id="edge5" class="edge">
<title>Hyperparameters-&gt;CopulaLogProbability</title>
<path fill="none" stroke="black" d="M135,-486.22C135,-457.65 135,-398.59 135,-348.6 135,-348.6 135,-348.6 135,-274.6 135,-222.31 151.89,-203.8 194,-172.8 231.11,-145.48 279.88,-131.89 323.21,-125.26"/>
<polygon fill="black" stroke="black" points="323.48,-128.76 332.89,-123.89 322.5,-121.82 323.48,-128.76"/>
</g>
<!-- LogProbability -->
<g id="node18" class="node">
<title>LogProbability</title>
<polygon fill="lightblue" stroke="black" points="632.74,-208.8 445.26,-208.8 445.26,-172.8 632.74,-172.8 632.74,-208.8"/>
<text text-anchor="middle" x="539" y="-186.6" font-family="Times,serif" font-size="14.00">Log Probability Density (lp_s)</text>
</g>
<!-- TransformedObservations&#45;&gt;LogProbability -->
<g id="edge6" class="edge">
<title>TransformedObservations-&gt;LogProbability</title>
<path fill="none" stroke="black" d="M294.35,-401.18C341.08,-361.19 456.15,-262.7 510.15,-216.49"/>
<polygon fill="black" stroke="black" points="512.11,-219.42 517.43,-210.26 507.55,-214.11 512.11,-219.42"/>
</g>
<!-- TransformedCovariates&#45;&gt;LogProbability -->
<g id="edge7" class="edge">
<title>TransformedCovariates-&gt;LogProbability</title>
<path fill="none" stroke="black" d="M539,-401.18C539,-362.34 539,-268.34 539,-220.62"/>
<polygon fill="black" stroke="black" points="542.5,-220.79 539,-210.79 535.5,-220.79 542.5,-220.79"/>
</g>
<!-- CovarianceMatrices -->
<g id="node17" class="node">
<title>CovarianceMatrices</title>
<polygon fill="lightblue" stroke="black" points="1262.35,-365.6 939.65,-365.6 939.65,-329.6 1262.35,-329.6 1262.35,-365.6"/>
<text text-anchor="middle" x="1101" y="-343.4" font-family="Times,serif" font-size="14.00">Covariance Matrices (cov_alpha_loc0, cov_scale, etc.)</text>
</g>
<!-- GroupDistanceMatrices&#45;&gt;CovarianceMatrices -->
<g id="edge8" class="edge">
<title>GroupDistanceMatrices-&gt;CovarianceMatrices</title>
<path fill="none" stroke="black" d="M878.18,-401.12C919.99,-391.26 972.38,-378.91 1015.86,-368.67"/>
<polygon fill="black" stroke="black" points="1016.59,-372.09 1025.52,-366.39 1014.99,-365.28 1016.59,-372.09"/>
</g>
<!-- LocationParameters -->
<g id="node9" class="node">
<title>LocationParameters</title>
<polygon fill="lightblue" stroke="black" points="1214.06,-522.4 939.94,-522.4 939.94,-486.4 1214.06,-486.4 1214.06,-522.4"/>
<text text-anchor="middle" x="1077" y="-500.2" font-family="Times,serif" font-size="14.00">Location Parameters (alpha_loc0, alpha_loc1)</text>
</g>
<!-- ScaleParameters -->
<g id="node10" class="node">
<title>ScaleParameters</title>
<polygon fill="lightblue" stroke="black" points="1384.41,-522.4 1231.59,-522.4 1231.59,-486.4 1384.41,-486.4 1384.41,-522.4"/>
<text text-anchor="middle" x="1308" y="-500.2" font-family="Times,serif" font-size="14.00">Scale Parameters (scale)</text>
</g>
<!-- ShapeParameters -->
<g id="node11" class="node">
<title>ShapeParameters</title>
<polygon fill="lightblue" stroke="black" points="1563.3,-522.4 1402.7,-522.4 1402.7,-486.4 1563.3,-486.4 1563.3,-522.4"/>
<text text-anchor="middle" x="1483" y="-500.2" font-family="Times,serif" font-size="14.00">Shape Parameters (shape)</text>
</g>
<!-- BasisFunctions -->
<g id="node12" class="node">
<title>BasisFunctions</title>
<polygon fill="lightblue" stroke="black" points="1892.55,-522.4 1581.45,-522.4 1581.45,-486.4 1892.55,-486.4 1892.55,-522.4"/>
<text text-anchor="middle" x="1737" y="-500.2" font-family="Times,serif" font-size="14.00">Basis Functions (basis_alpha_loc0, basis_scale, etc.)</text>
</g>
<!-- BasisFunctions&#45;&gt;RegressionCoefficients -->
<g id="edge9" class="edge">
<title>BasisFunctions-&gt;RegressionCoefficients</title>
<path fill="none" stroke="black" d="M1674.8,-485.94C1628.12,-472.84 1564.08,-454.87 1514.99,-441.09"/>
<polygon fill="black" stroke="black" points="1516.15,-437.78 1505.57,-438.44 1514.26,-444.52 1516.15,-437.78"/>
</g>
<!-- Hyperpriors -->
<g id="node13" class="node">
<title>Hyperpriors</title>
<polygon fill="lightblue" stroke="black" points="2107.39,-522.4 1910.61,-522.4 1910.61,-486.4 2107.39,-486.4 2107.39,-522.4"/>
<text text-anchor="middle" x="2009" y="-500.2" font-family="Times,serif" font-size="14.00">Hyperpriors (sill, nugget, range)</text>
</g>
<!-- Hyperpriors&#45;&gt;CovarianceMatrices -->
<g id="edge10" class="edge">
<title>Hyperpriors-&gt;CovarianceMatrices</title>
<path fill="none" stroke="black" d="M1946.73,-485.95C1858.01,-461.72 1689.81,-418.11 1544,-393.6 1537.08,-392.44 1395.23,-378.09 1273.89,-365.9"/>
<polygon fill="black" stroke="black" points="1274.4,-362.44 1264.1,-364.92 1273.7,-369.4 1274.4,-362.44"/>
</g>
<!-- MeanParameters -->
<g id="node15" class="node">
<title>MeanParameters</title>
<polygon fill="lightblue" stroke="black" points="1604.12,-365.6 1279.88,-365.6 1279.88,-329.6 1604.12,-329.6 1604.12,-365.6"/>
<text text-anchor="middle" x="1442" y="-343.4" font-family="Times,serif" font-size="14.00">Mean Parameters (alpha_loc0_mean, scale_mean, etc.)</text>
</g>
<!-- RegressionCoefficients&#45;&gt;MeanParameters -->
<g id="edge11" class="edge">
<title>RegressionCoefficients-&gt;MeanParameters</title>
<path fill="none" stroke="black" d="M1442,-401.3C1442,-394.01 1442,-385.33 1442,-377.14"/>
<polygon fill="black" stroke="black" points="1445.5,-377.22 1442,-367.22 1438.5,-377.22 1445.5,-377.22"/>
</g>
<!-- GroupLevelParameters -->
<g id="node16" class="node">
<title>GroupLevelParameters</title>
<polygon fill="lightblue" stroke="black" points="1309.68,-293.6 940.32,-293.6 940.32,-257.6 1309.68,-257.6 1309.68,-293.6"/>
<text text-anchor="middle" x="1125" y="-271.4" font-family="Times,serif" font-size="14.00">Group-Level Parameters (alpha_loc0_group, scale_group, etc.)</text>
</g>
<!-- MeanParameters&#45;&gt;GroupLevelParameters -->
<g id="edge12" class="edge">
<title>MeanParameters-&gt;GroupLevelParameters</title>
<path fill="none" stroke="black" d="M1362.83,-329.12C1317.92,-319.2 1261.57,-306.76 1214.99,-296.47"/>
<polygon fill="black" stroke="black" points="1215.99,-293.11 1205.47,-294.37 1214.48,-299.94 1215.99,-293.11"/>
</g>
<!-- GroupLevelParameters&#45;&gt;LogProbability -->
<g id="edge14" class="edge">
<title>GroupLevelParameters-&gt;LogProbability</title>
<path fill="none" stroke="black" d="M940.04,-269.2C828.16,-264.53 696.84,-256.15 642,-241.6 619.48,-235.63 595.98,-224.68 577.12,-214.56"/>
<polygon fill="black" stroke="black" points="578.93,-211.56 568.48,-209.79 575.55,-217.69 578.93,-211.56"/>
</g>
<!-- CumulativeDistribution -->
<g id="node19" class="node">
<title>CumulativeDistribution</title>
<polygon fill="lightblue" stroke="black" points="836.78,-208.8 651.22,-208.8 651.22,-172.8 836.78,-172.8 836.78,-208.8"/>
<text text-anchor="middle" x="744" y="-186.6" font-family="Times,serif" font-size="14.00">Cumulative Distribution (F_s)</text>
</g>
<!-- GroupLevelParameters&#45;&gt;CumulativeDistribution -->
<g id="edge15" class="edge">
<title>GroupLevelParameters-&gt;CumulativeDistribution</title>
<path fill="none" stroke="black" d="M1044.67,-257.14C983.37,-243.82 898.89,-225.46 835.08,-211.59"/>
<polygon fill="black" stroke="black" points="836.22,-208.26 825.7,-209.56 834.73,-215.1 836.22,-208.26"/>
</g>
<!-- CovarianceMatrices&#45;&gt;GroupLevelParameters -->
<g id="edge13" class="edge">
<title>CovarianceMatrices-&gt;GroupLevelParameters</title>
<path fill="none" stroke="black" d="M1106.93,-329.3C1109.49,-321.84 1112.55,-312.92 1115.41,-304.57"/>
<polygon fill="black" stroke="black" points="1118.71,-305.73 1118.64,-295.14 1112.09,-303.46 1118.71,-305.73"/>
</g>
<!-- LogProbability&#45;&gt;CopulaLogProbability -->
<g id="edge16" class="edge">
<title>LogProbability-&gt;CopulaLogProbability</title>
<path fill="none" stroke="black" d="M511.03,-172.32C496.89,-163.48 479.54,-152.64 464.28,-143.1"/>
<polygon fill="black" stroke="black" points="466.24,-140.19 455.9,-137.86 462.53,-146.13 466.24,-140.19"/>
</g>
<!-- CumulativeDistribution&#45;&gt;CopulaLogProbability -->
<g id="edge17" class="edge">
<title>CumulativeDistribution-&gt;CopulaLogProbability</title>
<path fill="none" stroke="black" d="M664.83,-172.32C619.92,-162.4 563.57,-149.96 516.99,-139.67"/>
<polygon fill="black" stroke="black" points="517.99,-136.31 507.47,-137.57 516.48,-143.14 517.99,-136.31"/>
</g>
<!-- CholeskyDecomposition -->
<g id="node20" class="node">
<title>CholeskyDecomposition</title>
<polygon fill="lightblue" stroke="black" points="426.81,-208.8 203.19,-208.8 203.19,-172.8 426.81,-172.8 426.81,-208.8"/>
<text text-anchor="middle" x="315" y="-186.6" font-family="Times,serif" font-size="14.00">Cholesky Decomposition (L_copula)</text>
</g>
<!-- CholeskyDecomposition&#45;&gt;CopulaLogProbability -->
<g id="edge18" class="edge">
<title>CholeskyDecomposition-&gt;CopulaLogProbability</title>
<path fill="none" stroke="black" d="M342.97,-172.32C357.11,-163.48 374.46,-152.64 389.72,-143.1"/>
<polygon fill="black" stroke="black" points="391.47,-146.13 398.1,-137.86 387.76,-140.19 391.47,-146.13"/>
</g>
<!-- PosteriorDensity -->
<g id="node22" class="node">
<title>PosteriorDensity</title>
<polygon fill="lightblue" stroke="black" points="506.15,-52 347.85,-52 347.85,-16 506.15,-16 506.15,-52"/>
<text text-anchor="middle" x="427" y="-29.8" font-family="Times,serif" font-size="14.00">Posterior Density (target)</text>
</g>
<!-- CopulaLogProbability&#45;&gt;PosteriorDensity -->
<g id="edge19" class="edge">
<title>CopulaLogProbability-&gt;PosteriorDensity</title>
<path fill="none" stroke="black" d="M427,-100.64C427,-89.95 427,-75.92 427,-63.57"/>
<polygon fill="black" stroke="black" points="430.5,-63.93 427,-53.93 423.5,-63.93 430.5,-63.93"/>
</g>
</g>
</svg>